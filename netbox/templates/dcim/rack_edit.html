{% extends 'generic/object_edit.html' %}
{% load form_helpers %}
{% load i18n %}

{% block form %}
    {% for field in form.hidden_fields %}
      {{ field }}
    {% endfor %}

    <div class="field-group my-5">
      <div class="row">
        <h2 class="col-9 offset-3">{% trans "Rack" %}</h2>
      </div>
      
      {% render_field form.site %}
      {% render_field form.location %}

      <div class="row mb-3{% if form.name.errors %} has-errors{% endif %}">
        <div class="col-sm-3 text-lg-end">
          <label for="{{ form.name.id_for_label }}" class="col-form-label d-inline-block{% if form.name.field.required %} required{% endif %}">
            {{ form.name.label }}
          </label>
        </div>

        <div class="col">
          <div class="d-flex">
            {{ form.name }}
            {% include 'inc/name_builder_modal.html' with form=name_builder_form target_field=form.name target_site=form.site target_location=form.location prefer_system='CS' prefer_subsystem='ARB' %}
          </div>

          {% if form.name.errors %}
            <div class="form-text text-danger">
              {% for error in form.name.errors %}{{ error }}{% if not forloop.last %}<br />{% endif %}{% endfor %}
            </div>
          {% endif %}
        </div>
      </div>
      
      {% render_field form.status %}
      {% render_field form.role %}
      {% render_field form.rack_type %}
      {% render_field form.description %}
      {% render_field form.airflow %}
      {% render_field form.tags %}
    </div>

    {% render_fieldset form fieldset=form.fieldsets.1 %}
    {% render_fieldset form fieldset=form.fieldsets.2 %}
    {% render_fieldset form fieldset=form.fieldsets.3 %}

    {% if form.custom_fields %}
      <div class="field-group my-5">
        <div class="row">
          <h2 class="col-9 offset-3">{% trans "Custom Fields" %}</h2>
        </div>
        {% render_custom_fields form %}
      </div>
    {% endif %}

    <div class="field-group mb-5">
      {% render_field form.comments %}
    </div>

    {# Meta fields #}
    <div class="bg-primary-subtle border border-primary rounded-1 pt-3 px-3 mb-3">
      {% render_field form.changelog_message %}
    </div>
{% endblock %}
